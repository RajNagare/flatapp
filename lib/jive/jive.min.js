/* Jive - The UI Library. For your health, dumm! */
(function(a){a.fn.drag=function(f,b,d){var c="string"==typeof f?f:"",e=a.isFunction(f)?f:a.isFunction(b)?b:null;0!==c.indexOf("drag")&&(c="drag"+c);d=(f==e?b:d)||{};return e?this.bind(c,d,e):this.trigger(c)};var e=a.event,c=e.special,d=c.drag={defaults:{which:1,distance:0,not:":input",handle:null,relative:!1,drop:!0,click:!1},datakey:"dragdata",noBubble:!0,add:function(f){var b=a.data(this,d.datakey),c=f.data||{};b.related+=1;a.each(d.defaults,function(a){void 0!==c[a]&&(b[a]=c[a])})},remove:function(){a.data(this,
d.datakey).related-=1},setup:function(){if(!a.data(this,d.datakey)){var f=a.extend({related:0},d.defaults);a.data(this,d.datakey,f);e.add(this,"touchstart mousedown",d.init,f);this.attachEvent&&this.attachEvent("ondragstart",d.dontstart)}},teardown:function(){(a.data(this,d.datakey)||{}).related||(a.removeData(this,d.datakey),e.remove(this,"touchstart mousedown",d.init),d.textselect(!0),this.detachEvent&&this.detachEvent("ondragstart",d.dontstart))},init:function(f){if(!d.touched){var b=f.data,k;
if(!(0!=f.which&&0<b.which&&f.which!=b.which)&&!a(f.target).is(b.not)&&(!b.handle||a(f.target).closest(b.handle,f.currentTarget).length))if(d.touched="touchstart"==f.type?this:null,b.propagates=1,b.mousedown=this,b.interactions=[d.interaction(this,b)],b.target=f.target,b.pageX=f.pageX,b.pageY=f.pageY,b.dragging=null,k=d.hijack(f,"draginit",b),b.propagates){if((k=d.flatten(k))&&k.length)b.interactions=[],a.each(k,function(){b.interactions.push(d.interaction(this,b))});b.propagates=b.interactions.length;
!1!==b.drop&&c.drop&&c.drop.handler(f,b);d.textselect(!1);d.touched?e.add(d.touched,"touchmove touchend",d.handler,b):e.add(document,"mousemove mouseup",d.handler,b);if(!d.touched||b.live)return!1}}},interaction:function(f,b){var c=a(f)[b.relative?"position":"offset"]()||{top:0,left:0};return{drag:f,callback:new d.callback,droppable:[],offset:c}},handler:function(f){var b=f.data;switch(f.type){case !b.dragging&&"touchmove":f.preventDefault();case !b.dragging&&"mousemove":if(Math.pow(f.pageX-b.pageX,
2)+Math.pow(f.pageY-b.pageY,2)<Math.pow(b.distance,2))break;f.target=b.target;d.hijack(f,"dragstart",b);b.propagates&&(b.dragging=!0);case "touchmove":f.preventDefault();case "mousemove":if(b.dragging){d.hijack(f,"drag",b);if(b.propagates){!1!==b.drop&&c.drop&&c.drop.handler(f,b);break}f.type="mouseup"}default:d.touched?e.remove(d.touched,"touchmove touchend",d.handler):e.remove(document,"mousemove mouseup",d.handler),b.dragging&&(!1!==b.drop&&c.drop&&c.drop.handler(f,b),d.hijack(f,"dragend",b)),
d.textselect(!0),!1===b.click&&b.dragging&&a.data(b.mousedown,"suppress.click",(new Date).getTime()+5),b.dragging=d.touched=!1}},hijack:function(f,b,c,g,j){if(c){var l=f.originalEvent,r=f.type,p=b.indexOf("drop")?"drag":"drop",m,q=g||0,h,n;g=!isNaN(g)?g:c.interactions.length;f.type=b;f.originalEvent=null;c.results=[];do if((h=c.interactions[q])&&!("dragend"!==b&&h.cancelled))n=d.properties(f,c,h),h.results=[],a(j||h[p]||c.droppable).each(function(g,j){n.target=j;f.isPropagationStopped=function(){return!1};
m=j?e.dispatch.call(j,f,n):null;!1===m?("drag"==p&&(h.cancelled=!0,c.propagates-=1),"drop"==b&&(h[p][g]=null)):"dropinit"==b&&h.droppable.push(d.element(m)||j);"dragstart"==b&&(h.proxy=a(d.element(m)||h.drag)[0]);h.results.push(m);delete f.result;if("dropinit"!==b)return m}),c.results[q]=d.flatten(h.results),"dropinit"==b&&(h.droppable=d.flatten(h.droppable)),"dragstart"==b&&!h.cancelled&&n.update();while(++q<g);f.type=r;f.originalEvent=l;return d.flatten(c.results)}},properties:function(a,b,c){var e=
c.callback;e.drag=c.drag;e.proxy=c.proxy||c.drag;e.startX=b.pageX;e.startY=b.pageY;e.deltaX=a.pageX-b.pageX;e.deltaY=a.pageY-b.pageY;e.originalX=c.offset.left;e.originalY=c.offset.top;e.offsetX=e.originalX+e.deltaX;e.offsetY=e.originalY+e.deltaY;e.drop=d.flatten((c.drop||[]).slice());e.available=d.flatten((c.droppable||[]).slice());return e},element:function(a){if(a&&(a.jquery||1==a.nodeType))return a},flatten:function(c){return a.map(c,function(b){return b&&b.jquery?a.makeArray(b):b&&b.length?d.flatten(b):
b})},textselect:function(c){a(document)[c?"unbind":"bind"]("selectstart",d.dontstart).css("MozUserSelect",c?"":"none");document.unselectable=c?"off":"on"},dontstart:function(){return!1},callback:function(){}};d.callback.prototype={update:function(){c.drop&&this.available.length&&a.each(this.available,function(a){c.drop.locate(this,a)})}};var l=e.dispatch;e.dispatch=function(c){if(0<a.data(this,"suppress."+c.type)-(new Date).getTime())a.removeData(this,"suppress."+c.type);else return l.apply(this,
arguments)};var j=e.fixHooks.touchstart=e.fixHooks.touchmove=e.fixHooks.touchend=e.fixHooks.touchcancel={props:"clientX clientY pageX pageY screenX screenY".split(" "),filter:function(c,b){if(b){var d=b.touches&&b.touches[0]||b.changedTouches&&b.changedTouches[0]||null;d&&a.each(j.props,function(a,b){c[b]=d[b]})}return c}};c.draginit=c.dragstart=c.dragend=d})(jQuery);
(function(a){var e=a.event,c=e.special.drag,d=c.add,l=c.teardown;c.noBubble=!1;c.livekey="livedrag";c.add=function(j){d.apply(this,arguments);var f=a.data(this,c.datakey);!f.live&&j.selector&&(f.live=!0,e.add(this,"draginit."+c.livekey,c.delegate))};c.teardown=function(){l.apply(this,arguments);var d=a.data(this,c.datakey)||{};d.live&&(e.remove(this,"draginit."+c.livekey,c.delegate),d.live=!1)};c.delegate=function(d){var f=[],b,k=a.data(this,"events")||{};a.each(k||[],function(g,k){0===g.indexOf("drag")&&
a.each(k||[],function(k,g){if(b=a(d.target).closest(g.selector,d.currentTarget)[0])e.add(b,g.origType+"."+c.livekey,g.origHandler||g.handler,g.data),0>a.inArray(b,f)&&f.push(b)})});return!f.length?!1:a(f).bind("dragend."+c.livekey,function(){e.remove(this,"."+c.livekey)})}})(jQuery);(function(){var a=!1,e=/xyz/.test(function(){xyz})?/\b_super\b/:/.*/;this.Class=function(){};Class.create=function(c){function d(){!a&&this.initialize&&this.initialize.apply(this,arguments)}var l=this.prototype;a=!0;var j=new this;a=!1;for(var f in c)j[f]="function"==typeof c[f]&&"function"==typeof l[f]&&e.test(c[f])?function(a,c){return function(){var d=this._super;this._super=l[a];var e=c.apply(this,arguments);this._super=d;return e}}(f,c[f]):c[f];d.prototype=j;d.constructor=d;d.create=arguments.callee;
return d}})();window.$j={regex:{empty:"",bit:/^(0|1)$/,num:/^-?([0-9]*)$/,alpha:/^[a-zA-z\s]+$/,alphanum:/^[a-zA-Z0-9]?[\s||\'||\"||\.||\?||\!||\-||a-zA-Z0-9]+$/,email:/^([a-zA-Z0-9_\.\-])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+$/,phone:/^([0-9]{3}( |-|.)?)?(\(?[0-9]{3}\)?|[0-9]{3})( |-|.)?([0-9]{3}( |-|.)?[0-9]{4}|[a-zA-Z0-9]{7})$/,cc:/^(?:4[0-9]{12}(?:[0-9]{3})?|5[1-5][0-9]{14}|6(?:011|5[0-9][0-9])[0-9]{12}|3[47][0-9]{13}|3(?:0[0-5]|[68][0-9])[0-9]{11}|(?:2131|1800|35\d{3})\d{11})$/,zip:/^(([0-9]{5})|([0-9]{5}[-][0-9]{4}))$/,
decimal:/^\d+\.\d{0,4}$/,price:/^\$?\s?[0-9\,]+(\.\d{0,4})?$/},init:function(){this.tabs={};this.forms={};this.msgs={};this.msg_index=0;this.slideshows={};this.dropdowns={};this.popups={};this.popup_index=0;this.crontab={};this.crontab_index=0;this.cron(this.get_time,1E3,"jiveTime");$(document).ready(function(){$j.init_dom()})},init_dom:function(){$(document).mousemove(this.get_mouse_position);this.get_viewport_dimensions();$(window).resize(this.get_viewport_dimensions)},get_mouse_position:function(a){$j.mouse=
{x:a.pageX,y:a.pageY}},get_viewport_dimensions:function(){$j.viewport={x:$(window).width(),y:$(window).height()}},msg:function(a){this.messenger.create(a)},hello_world:function(){this.msg({type:"success",content:"<h2>Hello World!</h2><p>If you're seeing this message, it means jive is ready to use!</p>",sticky:1})},cron:function(a,e,c){c=c?c:this.crontab_index++;var d={created:new Date,stop:function(){clearTimeout(this.timer)},timer:setInterval(function(){a(d)},e)};this.crontab[c]=d},get_time:function(){var a=
new Date;$j.time={hours:a.getHours(),mins:a.getMinutes(),secs:a.getSeconds(),time_of_day:"am"};10>$j.time.mins?$j.time.mins="0"+$j.time.mins:$j.time.mins=$j.time.mins;10>$j.time.secs?$j.time.secs="0"+$j.time.secs:$j.time.secs=$j.time.secs;12<$j.time.hours&&($j.time.hours-=12,$j.time.time_of_day="pm")}};$j.init();window.$j.canopy={create:function(){$j.canopy.overlay=$('<div id="canopy-overlay"/>');$j.canopy.container=$('<div id="canopy"/>').append($('<div id="canopy-close-btn"/>').text("Close").click($j.canopy.close));$(document.body).append($j.canopy.overlay).append($j.canopy.container)},display:function(){$j.canopy.container||$j.canopy.create();$j.canopy.overlay.show();$j.canopy.container.show()},close:function(){$j.canopy.overlay.hide();$j.canopy.container.hide()}};var Messenger=Class.create({initialize:function(){var a=this;this.container=$('<div id="jive-messenger"/>');this.messages_container=$('<div id="jive-messenger-messages"/>');this.close_btn=$('<div id="jive-messenger-close" style="display:none;"/>').text("x").click(this.close);$(document).ready(function(){a.container.append(a.messages_container);a.container.append(a.close_btn);$(document.body).append(a.container)})},create:function(a){var e=this;a={id:"msg-"+$j.msg_index,type:a.type?a.type:"notify",
content:a.content,timer:a.timer?a.timer:5E3,sticky:a.sticky?a.sticky:!1};a.container=$('<div class="jive-msg jive-msg-'+a.type+'" id="'+a.id+'"/>').append($('<div class="jive-msg-contents"/>').html(a.content));a.sticky?this.close_btn.show():this.close_btn.hide();this.messages_container.append(a.container);this.container.show();$j.msgs[$j.msg_index]=a;$j.msg_index++;a.sticky||setTimeout(function(){e.close()},a.timer)},clear:function(){this.close_btn.hide();this.messages_container.empty()},close:function(){$j.messenger.container.fadeOut();
setTimeout(function(){$j.messenger.messages_container.html("")},1E3)}});$j.messenger=new Messenger;var Tabs=Class.create({initialize:function(a){this.container_id=a.container;this.update_dom(this.container_id,a.index);$j.tabs[a.container]=this},update_dom:function(a,e){var c=this;this.container=$("#"+a);this.tabs=this.container.find(".tab:not(#"+a+" .jive-tabs .tab)");this.panels=this.container.find(".panel:not(#"+a+" .jive-tabs .panel)");this.current_index=e?e:0;this.tabs.each(function(a){$(this).click(function(){c.current_index!=a&&c.show_tab(a)})});this.panels.hide();this.show_tab(this.current_index)},
show_tab:function(a){this.current_index=a;this.panels.hide().removeClass("current");this.tabs.removeClass("current");this.container.find("#"+this.tabs[a].id).addClass("current");a="#"+this.tabs[a].id.replace("tab-","panel-");this.container.find(a).show().addClass("current")},next_tab:function(){this.show_tab((this.current_index+1+this.tabs.length)%this.tabs.length)},previous_tab:function(){this.show_tab((this.current_index-1+this.tabs.length)%this.tabs.length)},add_tab:function(a){this.container.append(a.tab,
a.panel);this.update_dom(this.container_id)}});$(document).ready(function(){$(".jive-tabs").each(function(){new Tabs({container:this.id})})});var JiveForm=Class.create({initialize:function(a){var e=this;this.config=a;this.container=$("#"+a.container);this.form_name=this.container.attr("name");this.fields={text:this.container.find("input[type=text]"),textareas:this.container.find("textarea"),radios:this.container.find("input[type=radio]"),checkboxes:this.container.find("input[type=checkbox]"),selects:this.container.find("select"),submits:this.container.find("input[type=submit]"),buttons:this.container.find("button")};this.clicked=null;this.fields.buttons.click(function(a){a.preventDefault();
e.clicked=this;e.submit(a)});this.container.submit(function(a){e.submit(a)});$j.forms[a.container]=this},validate:function(){for(var a in this.fields)"submits"!=a&&"buttons"!=a&&this.fields[a].each(function(){$(this).attr("disabled","disabled");for(var a in $j.regex)$(this).hasClass("valid-"+a)&&("empty"==a?0<this.value.length?($(this).addClass("valid"),$(this).removeClass("invalid")):($(this).addClass("invalid"),$(this).removeClass("valid")):$j.regex[a].test(this.value)?($(this).addClass("valid"),
$(this).removeClass("invalid")):($(this).addClass("invalid"),$(this).removeClass("valid")));$(this).removeAttr("disabled")});this.valid_fields=this.container.find(".valid");this.invalid_fields=this.container.find(".invalid");return 0==this.invalid_fields.length?!0:!1},submit:function(a){a.preventDefault();this.ajax_url=this.container.attr("action")+"?"+this.container.serialize();if(this.validate())if(this.success_callback)this.success_callback(this);else return!0;else if(this.failure_callback)this.failure_callback(this);
else return!1},success:function(a){this.success_callback=a},failure:function(a){this.failure_callback=a},reset:function(){for(var a in this.fields)switch(a){case "text":this.fields[a].each(function(){$(this).attr("value","")})}}});$(document).ready(function(){$(".jive-form").each(function(){new JiveForm({container:this.id})})});var Dropdown=Class.create({initialize:function(a){var e=this;this.container=$("#"+a.container);this.menu=this.container.find("> .dropdown-menu");this.timer=a.timer?a.timer:200;this.open=!1;this.container.mouseenter(function(){e.display()});this.container.mouseleave(function(){e.close()});$j.dropdowns[a.container]=this},display:function(){var a=this;clearTimeout(this.timeout);this.open||(this.timeout=setTimeout(function(){a.open=!0;a.menu.slideDown(a.timer)},this.timer))},close:function(){var a=this;
clearTimeout(this.timeout);this.open&&(this.timeout=setTimeout(function(){a.open=!1;a.menu.slideUp(a.timer)},this.timer))}});$(document).ready(function(){$(".dropdown").each(function(){new Dropdown({container:this.id})})});var Popup=Class.create({initialize:function(a){var e=this;a=$.extend({container:"popup-"+$j.popup_index++,title:"",html:!1,fullscreen:!1,width:$j.viewport.x/2,height:$j.viewport.y/2,top:($j.viewport.y-this.height)/2,left:($j.viewport.x-this.width)/2,offset:{top:50,left:50},confirm_close:!1,drag:!1,minimize:!1,resize_ondrag:!1},a);this.container_id=a.container;this.container=$('<div id="'+this.container_id+'" class="popup"/>').append($('<div class="popup-toolbar"/>').append($('<div class="popup-title"/>').html(a.title),
$('<div class="popup-close"/>').text("x").click(function(){e.close()})));this.content_container=$('<div id="'+this.container_id+'-contents" class="popup-contents" />');a.html&&this.set_contents(a.html);this.container.append(this.content_container);a.fullscreen&&(this.fullscreen=a.fullscreen,a.width=$j.viewport.x,a.height=$j.viewport.y);this.width=a.width;this.height=a.height;this.static_dimensions=a.width&&a.height&&!this.fullscreen?!0:!1;this.position={top:a.top,left:a.left,top_static:a.top?!0:!1,
left_static:a.left?!0:!1};this.offset=a.offset;this.container.css({width:e.width,height:e.height,top:e.position.top,left:e.position.left});this.confirm_close=a.confirm_close;this.drag=a.drag;this.minimize=a.minimize;this.resize_ondrag=a.resize_ondrag;$j.popups[this.container_id]=this;$(document.body).append(this.container);this.drag&&this.container.drag(function(a,d){$(this).css({top:d.offsetY,left:d.offsetX})},{handle:".popup-toolbar"});this.resize_ondrag&&(this.container.append($('<div class="popup-resize"/>')),
this.container.drag("start",function(a,d){d.width=$(this).width();d.height=$(this).height()}).drag(function(a,d){$(this).css({width:Math.max(20,d.width+d.deltaX),height:Math.max(20,d.height+d.deltaY)})},{handle:".popup-resize"}));$(window).resize(function(){e.update()});this.update()},update:function(){this.static_dimensions||this.resize();this.reposition();this.container.css({width:this.width,height:this.height,top:this.position.top,left:this.position.left})},reposition:function(){!this.position.top_static&&
!this.fullscreen&&(this.position.top=($j.viewport.y-this.height)/2,this.position.top<this.offset.top&&(this.position.top=this.offset.top));!this.position.left_static&&!this.fullscreen&&(this.position.left=($j.viewport.x-this.width)/2,this.position.left<this.offset.left&&(this.position.left=this.offset.left))},resize:function(){this.fullscreen?(this.width=$j.viewport.x,this.height=$j.viewport.y):(this.width=$j.viewport.x/2,this.height=$j.viewport.y/2)},close:function(a){this.confirm_close?confirm("Are you sure you would like to close this window?")&&
(a?(this.container.remove(),delete $j.popups[this.container_id]):this.container.hide()):a?(this.container.remove(),delete $j.popups[this.container_id]):this.container.hide()},set_title:function(a){this.container.find(".popup-title").html(a)},set_contents:function(a){this.content_container.html(a)}});$j.modal={display:function(a){a=$.extend({container:"modal"},a);new Popup(a);this.popup=$j.popups.modal;this.popup.fullscreen||($j.canopy.display(),$("#canopy-close-btn").hide(),$("#modal").find(".popup-close").click(function(){$j.canopy.close()}))},close:function(){this.popup.fullscreen||$j.canopy.close();this.popup.close()},resize:function(a){this.popup.width=a.width;this.popup.height=a.height;this.popup.update()}};var Slideshow=Class.create({initialize:function(a){$j.slideshows[a.container]=this;this.container=$("#"+a.container);this.slides=this.container.find(".slide");this.slide_duration=a.duration?a.duration:5E3;this.autostart=a.autostart?a.autostart:!1;this.loop=a.loop?a.loop:!0;this.reverse=a.reverse?a.reverse:!1;this.transition_interval=a.transition_interval?a.transition_interval:200;this.current_index=this.reverse?this.slides.length-1:0;this.completed=this.playing=!1;this.slides.hide();this.show_slide(!0);
this.container.hasClass("autostart")&&this.start()},show_slide:function(){if(!this.loop&&this.current_index>=this.slides.length)return this.current_index=this.slides.length-1,this.stop(),!1;this.current_index>=this.slides.length&&(this.current_index=0);if(!this.loop&&0>this.current_index)return this.current_index=0,this.stop(),!1;0>this.current_index&&(this.current_index=this.slides.length-1);this.slides.fadeOut(this.transition_interval).removeClass("current");this.current_slide=$(this.slides[this.current_index]).addClass("current").fadeIn(this.transition_interval)},
start:function(){var a=this,e=$(this.container).attr("id");if(this.playing)return!1;this.reverse?(this.playing=!0,$j.cron(function(){a.previous_slide()},this.slide_duration,e)):(this.playing=!0,$j.cron(function(){a.next_slide()},this.slide_duration,e));this.completed=!1},stop:function(){var a=$(this.container).attr("id");$j.crontab[a].stop();this.completed=!0;this.playing=!1},restart:function(){if(this.playing)return!1;this.reset();this.start()},reset:function(){this.stop();this.current_index=this.reverse?
this.slides.length-1:0;this.show_slide()},next_slide:function(){this.current_index++;this.show_slide()},previous_slide:function(){this.current_index--;this.show_slide()}});$(document).ready(function(){$(".jive-slideshow").each(function(){new Slideshow({container:this.id})})});
